<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MLS Essiam | Clinical Chemistry System</title>

<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#0f2027">


<link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">

<style>
body{
    font-family:'Inter',sans-serif;
    margin:0;
    background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
    color:#fff;
}

header{
    text-align:center;
    padding:25px;
}

header img{
    width:260px;
    max-width:90%;
}

.tabs{
    display:flex;
    justify-content:center;
    gap:15px;
    margin-bottom:20px;
}

.tab{
    padding:10px 20px;
    border-radius:20px;
    cursor:pointer;
    background:rgba(255,255,255,0.15);
    transition:0.3s;
}

.tab:hover, .active{
    background:#00b4d8;
}

.panel{
    display:none;
    max-width:900px;
    margin:0 auto 50px;
    background:rgba(255,255,255,0.08);
    backdrop-filter:blur(18px);
    padding:30px;
    border-radius:20px;
}

.grid{
    display:grid;
    grid-template-columns:repeat(auto-fit,minmax(250px,1fr));
    gap:20px;
}

.card{
    background:rgba(255,255,255,0.12);
    padding:15px;
    border-radius:15px;
}

input, select{
    width:100%;
    padding:8px;
    border-radius:8px;
    border:none;
    margin-top:5px;
}

.result{
    margin-top:25px;
    background:#fff;
    color:#000;
    padding:20px;
    border-radius:15px;
}

.normal{color:green;}
.high{color:red;}
.low{color:orange;}
</style>
</head>

<body>

<header>
<img src="logo.png">
</header>

<div class="tabs">
<div class="tab active" onclick="showPanel('rft')">RFT</div>
<div class="tab" onclick="showPanel('lft')">LFT</div>
<div class="tab" onclick="showPanel('lipid')">Lipid</div>
</div>

<!-- ================= RFT ================= -->
<div class="panel" id="rft" style="display:block;">
<h2>Renal Function Test</h2>
<div class="grid">
<div class="card">
Creatinine (µmol/L)
<input type="number" id="creat" oninput="calcRFT()">
</div>
<div class="card">
Age
<input type="number" id="age" oninput="calcRFT()">
</div>
<div class="card">
Sex
<select id="sex" onchange="calcRFT()">
<option value="female">Female</option>
<option value="male">Male</option>
</select>
</div>
<div class="card">
Race
<select id="race" onchange="calcRFT()">
<option value="none">Do not specify</option>
<option value="black">Black</option>
<option value="white">White</option>
</select>
</div>
</div>

<div class="result" id="rftResult">
Enter values to calculate eGFR
</div>
</div>

<!-- ================= LFT ================= -->
<div class="panel" id="lft">
<h2>Liver Function Test</h2>
<div class="grid">
<div class="card">Total Protein (g/L)
<input type="number" id="tp" oninput="calcLFT()"></div>
<div class="card">Albumin (g/L)
<input type="number" id="alb" oninput="calcLFT()"></div>
<div class="card">Total Bilirubin (µmol/L)
<input type="number" id="tb" oninput="calcLFT()"></div>
<div class="card">Direct Bilirubin (µmol/L)
<input type="number" id="db" oninput="calcLFT()"></div>
</div>

<div class="result" id="lftResult">
Enter values to calculate LFT
</div>
</div>

<!-- ================= LIPID ================= -->
<div class="panel" id="lipid">
<h2>Lipid Profile</h2>
<div class="grid">
<div class="card">Total Cholesterol (mmol/L)
<input type="number" id="tc" oninput="calcLipid()"></div>
<div class="card">HDL (mmol/L)
<input type="number" id="hdl" oninput="calcLipid()"></div>
<div class="card">Triglycerides (mmol/L)
<input type="number" id="tg" oninput="calcLipid()"></div>
</div>

<div class="result" id="lipidResult">
Enter values to calculate Lipid profile
</div>
</div>

<script>
function showPanel(id){
document.querySelectorAll('.panel').forEach(p=>p.style.display='none');
document.querySelectorAll('.tab').forEach(t=>t.classList.remove('active'));
document.getElementById(id).style.display='block';
event.target.classList.add('active');
}

/* ================= RFT ================= */
function calcRFT(){
let creat = parseFloat(document.getElementById("creat").value);
let age = parseFloat(document.getElementById("age").value);
let sex = document.getElementById("sex").value;
let race = document.getElementById("race").value;

if(isNaN(creat)||isNaN(age)) return;

let scr = creat/88.4; // convert to mg/dL
let k = (sex=="female")?0.7:0.9;
let a = (sex=="female")?-0.329:-0.411;
let min = Math.min(scr/k,1);
let max = Math.max(scr/k,1);

let egfr = 141*Math.pow(min,a)*Math.pow(max,-1.209)*Math.pow(0.993,age);
if(sex=="female") egfr*=1.018;
if(race=="black") egfr*=1.159;

let stage = (egfr>=90)?"Normal":
(egfr>=60)?"Mild CKD":
(egfr>=30)?"Moderate CKD":
(egfr>=15)?"Severe CKD":"Kidney Failure";

let roundedGFR = Math.round(egfr);

document.getElementById("rftResult").innerHTML=
`eGFR: <strong>${roundedGFR} mL/min/1.73m²</strong><br>
CKD Stage: <strong>${stage}</strong>`;
}

/* ================= LFT ================= */
function calcLFT(){

let tp = parseFloat(document.getElementById("tp").value);
let alb = parseFloat(document.getElementById("alb").value);
let tb = parseFloat(document.getElementById("tb").value);
let db = parseFloat(document.getElementById("db").value);

if(isNaN(tp)||isNaN(alb)||isNaN(tb)||isNaN(db)) return;

let glob = tp - alb;
let agr = alb / glob;
let indirect = tb - db;

document.getElementById("lftResult").innerHTML=
`Globulin: ${glob.toFixed(2)} g/L<br>
A/G Ratio: ${agr.toFixed(2)}<br>
Indirect Bilirubin: ${indirect.toFixed(2)} µmol/L`;
}

/* ================= LIPID ================= */
function calcLipid(){

let tc = parseFloat(document.getElementById("tc").value);
let hdl = parseFloat(document.getElementById("hdl").value);
let tg = parseFloat(document.getElementById("tg").value);

if(isNaN(tc)||isNaN(hdl)||isNaN(tg)) return;

let ldl = tc - hdl - (tg/2.2);
let risk = tc / hdl;

document.getElementById("lipidResult").innerHTML=
`LDL (Friedewald): ${ldl.toFixed(2)} mmol/L<br>
Coronary Risk Ratio (TC/HDL): ${risk.toFixed(2)}`;
}
</script>
<script>
if ("serviceWorker" in navigator) {
  navigator.serviceWorker.register("service-worker.js")
    .then(() => console.log("Service Worker Registered"));
}
</script>

</body>
</html>
